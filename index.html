<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Codepolarity.io</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Doto:wght@100..900&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Roboto Mono', monospace;
      background-color: #000;
      color: #fff;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }
    h1, h2, h3, h4, h5, h6, .main-heading, .main-text {
      font-family: 'Doto', sans-serif !important;
    }
    .corner-bracket {
      position: absolute; width: 24px; height: 24px;
    }
    .top-left { top: 0; left: 0; border-top: 3px solid #fff; border-left: 3px solid #fff; }
    .top-right { top: 0; right: 0; border-top: 3px solid #fff; border-right: 3px solid #fff; }
    .bottom-left { bottom: 0; left: 0; border-bottom: 3px solid #fff; border-left: 3px solid #fff; }
    .bottom-right { bottom: 0; right: 0; border-bottom: 3px solid #fff; border-right: 3px solid #fff; }
    .small-red-dot, .small-white-dot {
      width: 4px; height: 4px; border-radius: 50%; position: absolute;
    }
    .small-red-dot { background: red; }
    .small-white-dot { background: #fff; }
    .chart-bar {
      background: linear-gradient(to top, #60a7fa, #00ffd0, #fff);
      border-top: 1px solid #fff5;
    }
    .logo-glow {
      filter: drop-shadow(0 0 16px #60a7fa88) drop-shadow(0 0 32px #60a7fa44);
      animation: logoPulse 2.5s infinite alternate;
    }
    @keyframes logoPulse {
      0% { filter: drop-shadow(0 0 8px #60a7fa88) drop-shadow(0 0 16px #60a7fa44); }
      100% { filter: drop-shadow(0 0 24px #60a7fa) drop-shadow(0 0 48px #60a7fa44); }
    }
    .right-img-glow {
      box-shadow: 0 0 80px 10px #60a7fa55, 0 0 120px 40px #00ffd022;
      border-radius: 1.25rem;
      background: rgba(30, 41, 59, 0.15);
      position: relative;
    }
    .usage-breakdown-chart {
      background: #000;
      border-radius: 0.5rem;
      border: 1px solid #222;
      box-shadow: 0 2px 12px #000a;
      min-width: 0;
      overflow: visible;
    }
    .rotate-360 {
      transform: rotate(360deg);
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }
  </style>
  <style>
    /* Code Editor Animation Styles */
    .editor-cursor {
      display: inline-block;
      width: 8px;
      height: 1.2em;
      background: #fff;
      margin-left: 2px;
      animation: blink 1s steps(1) infinite;
      vertical-align: middle;
    }
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    .hl-keyword { color: #60a7fa; font-weight: bold; }
    .hl-string { color: #ffd700; }
    .hl-function { color: #00ffd0; }
    .hl-comment { color: #6b7280; font-style: italic; }
    .hl-variable { color: #fff; }
  </style>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <!-- Firebase App (the core Firebase SDK) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <!-- Firebase Auth -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCtsxaVgkd4utMd0OF6zriIuYwERGTlP6g",
      authDomain: "codepolarity-a8c63.firebaseapp.com",
      projectId: "codepolarity-a8c63",
      storageBucket: "codepolarity-a8c63.firebasestorage.app",
      messagingSenderId: "712143434692",
      appId: "1:712143434692:web:a7039ebf3cc1a56d1e6a91",
      measurementId: "G-R81RELCW6N"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
<body class="p-4 md:p-8">
<nav class="fixed top-0 left-0 w-full z-50 flex items-center justify-between px-8 py-2 bg-transparent backdrop-blur-md" style="height: 100px;">
<style>
  nav {
    background: rgba(0,0,0,0.45); /* fallback for browsers without backdrop-filter */
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
  }
</style>
  <div class="flex items-end gap-3 cursor-pointer ml-5" id="logo-toggle">
    <img src="assets/images/logo .svg" alt="Codepolarity Logo Part 1" id="logo-main" class="h-10 transition-transform duration-700" height="96px"/>
    <span class="text-3xl font-bold tracking-tight" style="font-family: 'Doto', sans-serif;">Codepolarity.io</span>
  </div>
  <!-- Desktop menu -->
  <ul class="hidden md:flex space-x-8 text-lg font-medium items-center mr-6">
    <li><a href="index.html" class="hover:text-blue-400 transition">Home</a></li>
    <li class="relative group" id="resources-dropdown">
      <button id="resources-btn" class="hover:text-blue-400 transition flex items-center focus:outline-none" aria-haspopup="true" aria-expanded="false" type="button">
        Resources
        <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
      </button>
      <ul id="resources-menu" class="absolute left-0 mt-2 w-40 bg-gray-900 border border-gray-700 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 dropdown-anim" tabindex="-1">
        <li><a href="Courses.html" class="block px-4 py-2 hover:bg-gray-800">Courses</a></li>
        <li><a href="#cheatsheets" class="block px-4 py-2 hover:bg-gray-800">Cheatsheets</a></li>
      </ul>
    </li>
    <li class="relative group" id="practice-dropdown">
      <button id="practice-btn" class="hover:text-blue-400 transition flex items-center focus:outline-none" aria-haspopup="true" aria-expanded="false" type="button">
        Practice
        <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
      </button>
      <ul id="practice-menu" class="absolute left-0 mt-2 w-40 bg-gray-900 border border-gray-700 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 dropdown-anim" tabindex="-1">
        <li><a href="typing_t.html" class="block px-4 py-2 hover:bg-gray-800">Typing</a></li>
        <li><a href="#speedcode" class="block px-4 py-2 hover:bg-gray-800">SpeedCode</a></li>
      </ul>
    </li>
    <li><a href="#about" class="hover:text-blue-400 transition">About</a></li>
    <li><a href="#contact" class="hover:text-blue-400 transition">Contact</a></li>
    <li id="desktop-login-btn"><button class="bg-blue-500 text-white px-4 py-1 rounded hover:bg-blue-600 transition" id="firebase-login-btn">Login</button></li>
    <li id="desktop-profile" class="relative hidden">
      <button id="profile-btn" class="flex items-center gap-2 px-3 py-1 rounded hover:bg-gray-800 focus:outline-none">
        <span class="inline-block w-7 h-7 rounded-full bg-blue-400 text-white flex items-center justify-center font-bold">U</span>
        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
      </button>
      <ul id="profile-menu" class="absolute right-0 mt-2 w-40 bg-gray-900 border border-gray-700 rounded shadow-lg opacity-0 invisible transition-all duration-200 z-50">
        <li><a href="profile.html" class="block px-4 py-2 hover:bg-gray-800">View Profile</a></li>
        <li><button id="logout-btn" class="block w-full text-left px-4 py-2 hover:bg-gray-800">Logout</button></li>
      </ul>
    </li>
  </ul>
</nav>
<!-- Mobile Hamburger -->
<button id="mobile-menu-btn" class="md:hidden fixed top-5 right-6 z-50 p-2 rounded bg-black/60 text-white focus:outline-none focus:ring-2 focus:ring-blue-400" aria-label="Open menu">
  <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/></svg>
</button>
<!-- Mobile Menu Overlay -->
<div id="mobile-menu" class="fixed inset-0 bg-black/80 backdrop-blur-lg z-40 flex flex-col items-center justify-start pt-24 px-6 text-lg font-medium text-white transform translate-x-full transition-transform duration-300 ease-in-out pointer-events-none" style="backdrop-filter: blur(18px); -webkit-backdrop-filter: blur(18px); background: rgba(0,0,0,0.8);">
  <a href="index.html" class="block w-full py-2 border-b border-gray-700">Home</a>
  <div class="w-full">
    <button class="w-full flex justify-between items-center py-2 border-b border-gray-700 focus:outline-none" id="mobile-resources-btn">
      Resources
      <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
    </button>
    <div id="mobile-resources-menu" class="pl-4 flex-col space-y-2 overflow-hidden transition-all duration-300 ease-in-out max-h-0">
      <a href="Courses.html" class="block py-1">Courses</a>
      <a href="#cheatsheets" class="block py-1">Cheatsheets</a>
    </div>
  </div>
  <div class="w-full">
    <button class="w-full flex justify-between items-center py-2 border-b border-gray-700 focus:outline-none" id="mobile-practice-btn">
      Practice
      <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
    </button>
    <div id="mobile-practice-menu" class="pl-4 flex-col space-y-2 overflow-hidden transition-all duration-300 ease-in-out max-h-0">
      <a href="typing_t.html" class="block py-1">Typing</a>
      <a href="#speedcode" class="block py-1">SpeedCode</a>
    </div>
  </div>
  <a href="#about" class="block w-full py-2 border-b border-gray-700">About</a>
  <a href="#contact" class="block w-full py-2 border-b border-gray-700">Contact</a>
  <div class="flex-1"></div>
  <button id="firebase-login-btn-mobile" class="block w-full py-2 bg-blue-500 text-white rounded text-center mb-6">Login</button>
  <div id="mobile-profile" class="w-full flex-col items-center hidden mb-6">
    <div class="flex items-center gap-2 mb-2">
      <span class="inline-block w-8 h-8 rounded-full bg-blue-400 text-white flex items-center justify-center font-bold">U</span>
      <span class="font-semibold">User</span>
    </div>
    <a href="profile.html" class="block w-full py-2 text-center border-b border-gray-700">View Profile</a>
    <button id="mobile-logout-btn" class="block w-full py-2 text-center text-red-400">Logout</button>
  </div>
</div>
<script>
// Dropdown for Resources (works on hover and click)
document.addEventListener('DOMContentLoaded', function() {
  const btn = document.getElementById('resources-btn');
  const menu = document.getElementById('resources-menu');
  const practiceBtn = document.getElementById('practice-btn');
  const practiceMenu = document.getElementById('practice-menu');
  let open = false;

  // Show/hide on click (for mobile/touch)
  btn.addEventListener('click', function(e) {
    e.stopPropagation();
    open = !open;
    menu.classList.toggle('opacity-100', open);
    menu.classList.toggle('visible', open);
    menu.classList.toggle('opacity-0', !open);
    menu.classList.toggle('invisible', !open);
    btn.setAttribute('aria-expanded', open);
    // Close Practice dropdown if open
    if (practiceMenu && practiceMenu.classList.contains('opacity-100')) {
      practiceMenu.classList.remove('opacity-100', 'visible');
      practiceMenu.classList.add('opacity-0', 'invisible');
      if (practiceBtn) practiceBtn.setAttribute('aria-expanded', 'false');
    }
  });

  // Close dropdown when clicking outside
  document.addEventListener('click', function(e) {
    if (open && !menu.contains(e.target) && !btn.contains(e.target)) {
      open = false;
      menu.classList.remove('opacity-100', 'visible');
      menu.classList.add('opacity-0', 'invisible');
      btn.setAttribute('aria-expanded', 'false');
    }
  });

  // Close dropdown when selecting an item
  menu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', function() {
      open = false;
      menu.classList.remove('opacity-100', 'visible');
      menu.classList.add('opacity-0', 'invisible');
      btn.setAttribute('aria-expanded', 'false');
    });
  });
});
</script>
<script>
// Dropdown for Practice (works on hover and click)
document.addEventListener('DOMContentLoaded', function() {
  const btn = document.getElementById('practice-btn');
  const menu = document.getElementById('practice-menu');
  const resourcesBtn = document.getElementById('resources-btn');
  const resourcesMenu = document.getElementById('resources-menu');
  let open = false;
  if (btn && menu) {
    btn.addEventListener('click', function(e) {
      e.stopPropagation();
      open = !open;
      menu.classList.toggle('opacity-100', open);
      menu.classList.toggle('visible', open);
      menu.classList.toggle('opacity-0', !open);
      menu.classList.toggle('invisible', !open);
      btn.setAttribute('aria-expanded', open);
      // Close Resources dropdown if open
      if (resourcesMenu && resourcesMenu.classList.contains('opacity-100')) {
        resourcesMenu.classList.remove('opacity-100', 'visible');
        resourcesMenu.classList.add('opacity-0', 'invisible');
        if (resourcesBtn) resourcesBtn.setAttribute('aria-expanded', 'false');
      }
    });
    document.addEventListener('click', function(e) {
      if (open && !menu.contains(e.target) && !btn.contains(e.target)) {
        open = false;
        menu.classList.remove('opacity-100', 'visible');
        menu.classList.add('opacity-0', 'invisible');
        btn.setAttribute('aria-expanded', 'false');
      }
    });
    menu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', function() {
        open = false;
        menu.classList.remove('opacity-100', 'visible');
        menu.classList.add('opacity-0', 'invisible');
        btn.setAttribute('aria-expanded', 'false');
      });
    });
  }
});
</script>
<div class="grid grid-cols-1 md:grid-cols-2 gap-8 h-full min-h-screen p-6 md:p-4">
  <!-- LEFT PANEL -->
  <div class="flex flex-col justify-between space-y-8 z-10">
    <header>
      <h1></h1>
    </header>
    <main class="space-y-10">
      <section style="margin-top: 48px;">
        <h2 class="font-bold tracking-tight" style="font-size:5.4rem; line-height:1;">
          <span style="font-size:3rem; font-weight:400; display:inline-block;">welcome to</span>
          <span style="display:inline-block; margin-top:-3rem;">codepolarity <span class="text-blue-400">•</span></span>
        </h2>
        <p class="mt-4 text-gray-400">An all-in-one coding environment designed to help you learn, build, and grow — with structure, clarity, and purpose</p>
        <div class="mt-6 sm:mt-8 flex flex-col sm:flex-row gap-3 sm:gap-4 w-full max-w-xs hero-btn-group">
          <a href="code_editor.html" class="bg-white text-black px-6 py-0.5 font-bold rounded shadow hover:bg-blue-100 transition text-center flex items-center justify-center">Start Coding</a>
          <a href="#features" class="border border-white px-6 py-0.5 font-bold rounded hover:bg-white hover:text-black transition text-center flex items-center justify-center">Explore Features</a>
        </div>
      </section>
      <div class="flex items-center space-x-2 text-gray-400">
        <span>[</span>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <div class="w-4 h-4 bg-gray-600"></div>
        <span>]</span>
      </div>
      <section>
        <div class="flex justify-between items-center">
          <h4 class="text-xl font-bold">USAGE BREAKDOWN</h4>
          <div class="flex items-center gap-2 sm:gap-4 flex-wrap">
            <div class="border border-gray-600 px-3 py-1 flex-shrink-0" id="days-visited">1 day</div>
            <div class="border border-gray-600 px-3 py-1 flex-shrink-0 flex items-center min-w-0">
              Type:
              <div class="relative inline-block" id="custom-feature-dropdown">
                <button id="feature-dropdown-btn" type="button" class="flex items-center px-2 py-1 text-white bg-transparent hover:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400 rounded transition text-sm">
                  <span id="feature-dropdown-label">All Features</span>
                  <svg class="ml-1 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
                </button>
                <ul id="feature-dropdown-list" class="absolute left-0 mt-1 w-44 bg-gray-900 border border-gray-700 rounded shadow-lg z-50 text-white opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 text-sm" tabindex="-1" style="min-width:150px;">
                  <li><button class="w-full text-left px-4 py-2 hover:bg-gray-800" data-value="all">All Features</button></li>
                  <li><button class="w-full text-left px-4 py-2 hover:bg-gray-800" data-value="editor">Editor Usage</button></li>
                  <li><button class="w-full text-left px-4 py-2 hover:bg-gray-800" data-value="ai">AI Assistant</button></li>
                  <li><button class="w-full text-left px-4 py-2 hover:bg-gray-800" data-value="pm">Project Management</button></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="mt-4 grid grid-cols-2 gap-4 text-gray-400 text-sm">
          <div class="flex items-center space-x-2"><span>[</span> <div class="w-3 h-3" style="background:#fff176"></div><span>Editor Usage</span> <span>]</span></div>
          <div class="flex items-center space-x-2"><span>[</span> <div class="w-3 h-3" style="background:#ffb300"></div><span>AI Assistant</span> <span>]</span></div>
          <div class="flex items-center space-x-2"><span>[</span> <div class="w-3 h-3" style="background:#e53935"></div><span>Project Management</span> <span>]</span></div>
        </div>
        <div class="mt-6">
          <div class="usage-breakdown-chart" style="background:#000; border-radius:0.5rem; border:1px solid #222; box-shadow:0 2px 12px #000a; padding: 1.5rem 1rem 0.5rem 1rem;">
            <canvas id="usageBreakdownChart" height="220"></canvas>
          </div>
          <!-- Mobile: below usage breakdown graph, above 3D model -->
          <div id="wave-metrics-mobile" class="flex sm:hidden justify-between mt-2 mb-2 text-xs font-bold text-white px-2 w-full">
            <div id="metric-coding-mobile"></div>
            <div id="metric-wpm-mobile"></div>
            <div id="metric-ai-mobile"></div>
          </div>
        </div>
      </section>
    </main>
      </div>
  <!-- RIGHT PANEL -->
  <div style="position: relative; display: flex; align-items: center; justify-content: center; min-height: 400px; background: #000;">
    <!-- 3D Model -->
    <div class="w-full flex justify-center items-start" style="min-height:340px; min-width:320px; margin-top:32px;">
      <pre class="p-0 m-0 text-base sm:text-lg md:text-xl leading-relaxed font-mono text-left whitespace-pre-wrap bg-transparent border-none shadow-none max-w-full overflow-x-auto" id="editor-content" style="min-height:120px; background:none; border:none; font-size:1.1rem;"></pre>
    </div>
  </div>
<!-- Desktop: original placement -->
<div id="wave-metrics" class="hidden sm:flex justify-between mt-2 text-sm font-bold text-white px-2">
  <div id="metric-coding"></div>
  <div id="metric-wpm"></div>
  <div id="metric-ai"></div>
</div>
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const numBars = 72;
const hours = Array.from({length: numBars}, (_,i)=> ((i/3)+1).toFixed(2));
function genFluidWave(offset, amp, base, freq1, freq2, phase2, jitter=0) {
  return Array.from({length:numBars}, (_,i) => {
    const t = i/numBars;
    const val = base
      + amp * Math.sin(2*Math.PI*freq1*t + offset)
      + (amp/2) * Math.sin(2*Math.PI*freq2*t + phase2)
      + (jitter ? (Math.random()-0.5)*jitter : 0);
    return Math.max(0, Math.round(val));
  });
}
const seriesColors = ['#fff176', '#ffb300', '#e53935'];
let phase = 0;
const datasets = [
  { label: 'Editor Usage', data: [], backgroundColor: seriesColors[0], borderWidth: 0, barPercentage: 1.0, categoryPercentage: 1.0, borderRadius: 0, stack: 'Stack 0' },
  { label: 'AI Assistant', data: [], backgroundColor: seriesColors[1], borderWidth: 0, barPercentage: 1.0, categoryPercentage: 1.0, borderRadius: 0, stack: 'Stack 0' },
  { label: 'Project Management', data: [], backgroundColor: seriesColors[2], borderWidth: 0, barPercentage: 1.0, categoryPercentage: 1.0, borderRadius: 0, stack: 'Stack 0' }
];
window.datasets = datasets;
const ctx = document.getElementById('usageBreakdownChart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'bar',
  data: { labels: hours, datasets: datasets },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: { legend: { display: false }, tooltip: { enabled: false } },
    scales: {
      x: {
        stacked: true,
        grid: { color: '#222', lineWidth: 1, drawTicks: false },
        ticks: {
          color: '#888',
          font: { size: 12 },
          callback: function(val, idx) {
            return (idx % 3 === 0) ? (Math.floor(idx/3)+1).toString() : '';
          },
          maxRotation: 0, minRotation: 0, padding: 2
        },
        border: { display: false },
      },
      y: {
        stacked: true,
        grid: { color: '#222', lineWidth: 1, drawTicks: false },
        ticks: { color: '#888', font: { size: 10 }, stepSize: 10, padding: 2, display: false },
        border: { display: false },
      },
    },
    elements: { bar: { borderRadius: 0, borderSkipped: false } },
    layout: { padding: 0 },
    barThickness: 3,
    categoryPercentage: 1.0,
    barPercentage: 1.0,
    animation: false
  }
});
let codingLines = 1821; // Replace with real-time value from Monaco
let typingWPM = 92;     // Replace with real-time value from KeyPolarity
let aiInteractions = 5; // Replace with real-time value from Polaris

let displayCoding = codingLines, displayWPM = typingWPM, displayAI = aiInteractions;
function lerp(a, b, t) { return a + (b - a) * t; }

function animateWave() {
  phase += 0.04;
  // Smoothly interpolate displayed values
  displayCoding = lerp(displayCoding, codingLines, 0.1);
  displayWPM = lerp(displayWPM, typingWPM, 0.1);
  displayAI = lerp(displayAI, aiInteractions, 0.1);

  // Update floating metrics
  document.getElementById('metric-coding').textContent = `Lines of Code: ${Math.round(displayCoding)}`;
  document.getElementById('metric-wpm').textContent = `WPM: ${Math.round(displayWPM)}`;
  document.getElementById('metric-ai').textContent = `AI Interactions: ${Math.round(displayAI)}`;

  // Animate waves: amplitude/frequency based on metrics
  chart.data.datasets[0].data = genFluidWave(phase, 2 + displayCoding/1000, 10, 1, 2.5, Math.PI/3, 1.2);
  chart.data.datasets[1].data = genFluidWave(phase + Math.PI/8, 1 + displayWPM/100, 7, 1.2, 2.2, Math.PI/2, 1.2);
  chart.data.datasets[2].data = genFluidWave(phase + Math.PI/4, 1 + displayAI, 4, 1.5, 2.1, Math.PI/1.5, 1.2);

  chart.update('none');
  requestAnimationFrame(animateWave);
}
animateWave();

// Example: update these values from your app in real time
// setInterval(() => { codingLines += Math.random() > 0.5 ? 1 : 0; }, 1000);
// setInterval(() => { typingWPM = 80 + Math.random()*40; }, 2000);
// setInterval(() => { aiInteractions += Math.random() > 0.95 ? 1 : 0; }, 500);
</script>
<script>
  // Toggle 360deg rotation on logo-main when logo-toggle is clicked
  document.addEventListener('DOMContentLoaded', function() {
    const logoToggle = document.getElementById('logo-toggle');
    const logoMain = document.getElementById('logo-main');
    let rotated = false;
    logoToggle.addEventListener('click', function() {
      rotated = !rotated;
      if (rotated) {
        logoMain.classList.add('rotate-360');
      } else {
        logoMain.classList.remove('rotate-360');
      }
    });
  });
</script>
<script>
// Animated Code Editor Typing Effect
const codeLines = [
  '<span class="hl-comment">// Welcome to Codepolarity Editor</span>',
  '<span class="hl-keyword">function</span> <span class="hl-function">greet</span>(<span class="hl-variable">name</span>) {',
  '  <span class="hl-keyword">return</span> <span class="hl-string">`Hello, ${name}!`</span>;',
  '}',
  '',
  '<span class="hl-keyword">const</span> <span class="hl-variable">user</span> = <span class="hl-string">"Developer"</span>;',
  '<span class="hl-keyword">console</span>.log(<span class="hl-function">greet</span>(<span class="hl-variable">user</span>));',
];
const editorContent = document.getElementById('editor-content');
let line = 0, char = 0, typing = true;
function typeLine() {
  if (line >= codeLines.length) return;
  let current = codeLines[line];
  let displayed = current.slice(0, char);
  editorContent.innerHTML =
    codeLines.slice(0, line).join('\n') +
    (line > 0 ? '\n' : '') +
    displayed + '<span class="editor-cursor"></span>';
  if (char < current.length) {
    char++;
    setTimeout(typeLine, 24 + Math.random() * 32);
  } else {
    char = 0;
    line++;
    setTimeout(typeLine, 350);
  }
}
typeLine();
</script>
<script>
// Track unique days user has visited Codepolarity
function getTodayString() {
  const today = new Date();
  return today.getFullYear() + '-' + (today.getMonth()+1) + '-' + today.getDate();
}
function updateDaysVisited() {
  let days = JSON.parse(localStorage.getItem('cp_days_visited') || '[]');
  const today = getTodayString();
  if (!days.includes(today)) {
    days.push(today);
    localStorage.setItem('cp_days_visited', JSON.stringify(days));
  }
  const box = document.getElementById('days-visited');
  if (box) {
    box.textContent = days.length + (days.length === 1 ? ' day' : ' days');
  }
}
updateDaysVisited();
</script>
<script>
// Custom feature type dropdown logic (click only)
document.addEventListener('DOMContentLoaded', function() {
  const btn = document.getElementById('feature-dropdown-btn');
  const list = document.getElementById('feature-dropdown-list');
  const label = document.getElementById('feature-dropdown-label');
  const wrapper = document.getElementById('custom-feature-dropdown');
  let open = false;
  const options = list.querySelectorAll('button[data-value]');
  const valueToLabel = {
    all: 'All Features',
    editor: 'Editor Usage',
    ai: 'AI Assistant',
    pm: 'Project Management'
  };
  function setOpen(val) {
    open = val;
    if (open) {
      wrapper.classList.add('open');
      list.focus();
    } else {
      wrapper.classList.remove('open');
    }
  }
  btn.addEventListener('click', function(e) {
    e.stopPropagation();
    setOpen(!open);
  });
  options.forEach(option => {
    option.addEventListener('click', function(e) {
      const val = option.getAttribute('data-value');
      label.textContent = valueToLabel[val];
      setOpen(false);
      // Update chart
      if (window.chart && window.datasets) {
        if (val === 'all') {
          chart.data.datasets = window.datasets;
        } else if (val === 'editor') {
          chart.data.datasets = [window.datasets[0]];
        } else if (val === 'ai') {
          chart.data.datasets = [window.datasets[1]];
        } else if (val === 'pm') {
          chart.data.datasets = [window.datasets[2]];
        }
        chart.update();
      }
    });
  });
  // Keyboard navigation
  btn.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowDown' || e.key === 'Enter' || e.key === ' ') {
      setOpen(true);
      options[0].focus();
      e.preventDefault();
    }
  });
  options.forEach((option, idx) => {
    option.addEventListener('keydown', function(e) {
      if (e.key === 'ArrowDown') {
        if (idx < options.length - 1) options[idx+1].focus();
        e.preventDefault();
      } else if (e.key === 'ArrowUp') {
        if (idx > 0) options[idx-1].focus();
        e.preventDefault();
      } else if (e.key === 'Escape') {
        setOpen(false);
        btn.focus();
      }
    });
  });
  // Close on outside click
  document.addEventListener('click', function(e) {
    if (open && !wrapper.contains(e.target)) setOpen(false);
  });
});
</script>
<script>
// Sync metrics to mobile metrics bar
function syncWaveMetrics() {
  const coding = document.getElementById('metric-coding');
  const wpm = document.getElementById('metric-wpm');
  const ai = document.getElementById('metric-ai');
  const codingM = document.getElementById('metric-coding-mobile');
  const wpmM = document.getElementById('metric-wpm-mobile');
  const aiM = document.getElementById('metric-ai-mobile');
  if (coding && codingM) codingM.textContent = coding.textContent;
  if (wpm && wpmM) wpmM.textContent = wpm.textContent;
  if (ai && aiM) aiM.textContent = ai.textContent;
}
setInterval(syncWaveMetrics, 300);
</script>
<style>
  /* Custom dropdown for feature type */
  #custom-feature-dropdown.open #feature-dropdown-list {
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0);
  }
  #feature-dropdown-list {
    opacity: 0;
    visibility: hidden;
    transform: translateY(-16px);
    transition: opacity 150ms cubic-bezier(0.4,0,0.2,1),
                transform 150ms cubic-bezier(0.4,0,0.2,1),
                visibility 150ms cubic-bezier(0.4,0,0.2,1);
  }
  /* Dropdown open/close animation */
  .dropdown-anim {
    transform: translateY(-16px);
    opacity: 0;
    visibility: hidden;
    transition: opacity 150ms cubic-bezier(0.4,0,0.2,1),
                transform 150ms cubic-bezier(0.4,0,0.2,1),
                visibility 150ms cubic-bezier(0.4,0,0.2,1);
  }
  .opacity-100.visible.dropdown-anim {
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0);
  }
  .opacity-0.invisible.dropdown-anim {
    opacity: 0 !important;
    visibility: hidden !important;
    transform: translateY(-16px);
  }
  @media (max-width: 640px) {
    .usage-breakdown-chart { padding: 0.5rem 0.25rem 0.25rem 0.25rem !important; }
    #editor-content { font-size: 1rem !important; }
    .main-heading, .main-text, h2 { font-size: 1.5rem !important; }
    .flex.space-x-4, .flex.gap-4 { flex-direction: column !important; gap: 0.5rem !important; }
    .w-full.max-w-xl { min-width: 0 !important; }
    .hero-btn-group a {
      width: 100% !important;
      max-width: 320px;
      display: block;
      text-align: center;
    }
  }
  @media (min-width: 640px) {
    .hero-btn-group a {
      min-width: 180px !important;
    }
  }
  @media (max-width: 640px) {
    #logo-toggle { margin-left: 0.5rem !important; }
  }
  #mobile-menu {
    will-change: transform;
  }
</style>
<script>
// Mobile menu open/close logic with sliding animation
document.addEventListener('DOMContentLoaded', function() {
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileResourcesBtn = document.getElementById('mobile-resources-btn');
  const mobileResourcesMenu = document.getElementById('mobile-resources-menu');
  const mobilePracticeBtn = document.getElementById('mobile-practice-btn');
  const mobilePracticeMenu = document.getElementById('mobile-practice-menu');
  let mobileMenuOpen = false;
  function openMenu() {
    mobileMenu.classList.remove('translate-x-full', 'pointer-events-none');
    mobileMenu.classList.add('translate-x-0');
    document.body.style.overflow = 'hidden';
    mobileMenuOpen = true;
  }
  function closeMenu() {
    mobileMenu.classList.add('translate-x-full', 'pointer-events-none');
    mobileMenu.classList.remove('translate-x-0');
    document.body.style.overflow = '';
    mobileMenuOpen = false;
    // Close dropdowns
    closeMobileDropdown(mobileResourcesMenu);
    closeMobileDropdown(mobilePracticeMenu);
  }
  mobileMenuBtn.addEventListener('click', function() {
    if (mobileMenuOpen) {
      closeMenu();
    } else {
      openMenu();
    }
  });
  document.addEventListener('keydown', function(e) {
    if (mobileMenuOpen && e.key === 'Escape') {
      closeMenu();
    }
  });
  // Dropdowns in mobile menu with slide
  function toggleMobileDropdown(menu) {
    if (menu.style.maxHeight && menu.style.maxHeight !== '0px') {
      closeMobileDropdown(menu);
    } else {
      menu.classList.remove('max-h-0');
      menu.classList.add('max-h-32');
      menu.style.maxHeight = menu.scrollHeight + 'px';
    }
  }
  function closeMobileDropdown(menu) {
    menu.classList.add('max-h-0');
    menu.classList.remove('max-h-32');
    menu.style.maxHeight = '0px';
  }
  mobileResourcesBtn.addEventListener('click', function() {
    toggleMobileDropdown(mobileResourcesMenu);
  });
  mobilePracticeBtn.addEventListener('click', function() {
    toggleMobileDropdown(mobilePracticeMenu);
  });
  // Close menu when clicking outside (optional, for overlay)
  mobileMenu.addEventListener('click', function(e) {
    if (e.target === mobileMenu) closeMenu();
  });
});
</script>
<script>
// Firebase Auth UI logic
function updateAuthUIFirebase(user) {
  // Desktop
  const loginBtn = document.getElementById('desktop-login-btn');
  const profileLi = document.getElementById('desktop-profile');
  if (loginBtn && profileLi) {
    if (user) {
      loginBtn.style.display = 'none';
      profileLi.classList.remove('hidden'); // Remove hidden class to show profile
    } else {
      loginBtn.style.display = '';
      profileLi.classList.add('hidden'); // Add hidden class to hide profile
    }
  }
  // Mobile
  document.getElementById('firebase-login-btn-mobile').style.display = user ? 'none' : '';
  document.getElementById('mobile-profile').style.display = user ? 'flex' : 'none';
  // Profile info
  if (user) {
    // Desktop avatar
    const avatar = document.querySelector('#desktop-profile .w-7');
    if (avatar && user.photoURL) {
      avatar.style.backgroundImage = `url('${user.photoURL}')`;
      avatar.style.backgroundSize = 'cover';
      avatar.textContent = '';
    } else if (avatar) {
      avatar.textContent = user.displayName ? user.displayName[0] : 'U';
    }
    // Mobile avatar and name
    const avatarM = document.querySelector('#mobile-profile .w-8');
    const nameM = document.querySelector('#mobile-profile .font-semibold');
    if (avatarM && user.photoURL) {
      avatarM.style.backgroundImage = `url('${user.photoURL}')`;
      avatarM.style.backgroundSize = 'cover';
      avatarM.textContent = '';
    } else if (avatarM) {
      avatarM.textContent = user.displayName ? user.displayName[0] : 'U';
    }
    if (nameM) nameM.textContent = user.displayName || 'User';
  }
}
firebase.auth().onAuthStateChanged(function(user) {
  updateAuthUIFirebase(user);
});
// Google login
document.getElementById('firebase-login-btn').onclick = function() {
  firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider());
};
document.getElementById('firebase-login-btn-mobile').onclick = function() {
  firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider());
};
// Logout
document.getElementById('logout-btn').onclick = function() {
  firebase.auth().signOut();
};
document.getElementById('mobile-logout-btn').onclick = function() {
  firebase.auth().signOut();
  // Also close mobile menu
  document.getElementById('mobile-menu').classList.add('translate-x-full', 'pointer-events-none');
  document.getElementById('mobile-menu').classList.remove('translate-x-0');
  document.body.style.overflow = '';
};
// Desktop profile dropdown
const profileBtn = document.getElementById('profile-btn');
const profileMenu = document.getElementById('profile-menu');
if (profileBtn && profileMenu) {
  let open = false;
  profileBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    open = !open;
    profileMenu.classList.toggle('opacity-0', !open);
    profileMenu.classList.toggle('invisible', !open);
    profileMenu.classList.toggle('opacity-100', open);
    profileMenu.classList.toggle('visible', open);
  });
  document.addEventListener('click', function(e) {
    if (open && !profileMenu.contains(e.target) && !profileBtn.contains(e.target)) {
      open = false;
      profileMenu.classList.add('opacity-0', 'invisible');
      profileMenu.classList.remove('opacity-100', 'visible');
    }
  });
}
</script>
</body>
</html>